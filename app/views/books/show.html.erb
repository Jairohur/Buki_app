<div id="notifications"></div>

<div class="book-container" style="max-width: 1200px; margin: 0 auto; padding: 24px 10%; font-family: sans-serif;">
  <!-- Back Link and Book Title -->
  <div style="margin-bottom: 24px;">
    <%= link_to books_path, style: "text-decoration: none; font-size: 36px; color: black;" do %>
      <i class="fa-solid fa-angle-left"></i>
    <% end %>
    <h1 style="display: inline-block; margin-left: 12px;"><%= @book.title %></h1>
    <% if @book.author.present? %>
      <h2 style="color: grey; font-weight: 400;">By <%= @book.author %></h2>
    <% end %>
  </div>

  <div class="row" style="background: white; border-radius: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); padding: 32px 24px;">
    <!-- Cover Image Column -->
    <div class="col-5">
      <div style="background: white; text-align: center; padding: 16px; border-radius: 12px; margin-bottom: 24px; margin-right: 32px;">
        <% if @book.cover_image.attached? %>
          <%= image_tag @book.cover_image, alt: @book.title, style: "max-width: 100%; height: 350px; object-fit: contain;" %>
        <% else %>
          <p>No cover image available.</p>
        <% end %>
      </div>
    </div>

    <!-- Book Info & Form Column -->
    <div class="col-7 d-flex flex-column justify-content-between">
      <div>
        <% if @book.description.present? %>
          <p style="font-size: 16px; line-height: 1.6; margin-bottom: 24px;">
            <%= @book.description %>
          </p>
        <% end %>

        <!-- Open Book Form -->
        <%= form_with url: book_page_path(@book, 1), method: :get, html: { class: 'w-100' } do %>
          <fieldset class="form-group">
            <legend class="col-form-label pt-0">Select Languages:</legend>

            <% current_user.languages.each_with_index do |language, index| %>
              <div class="form-check mb-2" style="background:rgb(238, 238, 238); outline-offset: 0px; border-radius: 16px; padding: 6px;">
                <input class="form-check-input" type="checkbox"
                  value="<%= language %>"
                  name="languages[]"
                  id="<%= language.parameterize %>-<%= index %>"
                  <%= 'checked' if index == 0 %>>
                <label class="form-check-label" for="<%= language.parameterize %>-<%= index %>">
                  <%= full_name(language) %>
                </label>
              </div>
            <% end %>

            <div class="mt-4">
              <%= render "favorites/create", book: @book %>
            </div>
          </fieldset>

          <div class="mt-5">
            <button type="submit" class="btn btn-primary text-white custom-button">
              Open Book <span style="margin-left: 8px;"><i class="fa-solid fa-book-open"></i></span>
            </button>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
