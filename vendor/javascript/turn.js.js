// turn.js@1.0.5 downloaded from https://ga.jspm.io/npm:turn.js@1.0.5/index.js

import t from"jquery";var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var a=t;var i,r="",s=Math.PI,n=s/2,o="ontouchstart"in window,p=o?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},h={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},l=["single","double"],g={page:1,gradients:true,duration:600,acceleration:true,display:"double",when:null},d={folding:null,corners:"forward",cornerSize:100,gradients:true,duration:600,acceleration:true},u=6,c={0:{top:0,left:0,right:"auto",bottom:"auto"},1:{top:0,right:0,left:"auto",bottom:"auto"}},divAtt=function(t,e,a,i){return{css:{position:"absolute",top:t,left:e,overflow:i||"hidden","z-index":a||"auto"}}},bezier=function(t,e,a,i,r){var s=1-r,n=s*s*s,o=r*r*r;return point2D(Math.round(n*t.x+3*r*s*s*e.x+3*r*r*s*a.x+o*i.x),Math.round(n*t.y+3*r*s*s*e.y+3*r*r*s*a.y+o*i.y))},rad=function(t){return t/180*s},deg=function(t){return t/s*180},point2D=function(t,e){return{x:t,y:e}},translate=function(t,e,a){return i&&a?" translate3d("+t+"px,"+e+"px, 0px) ":" translate("+t+"px, "+e+"px) "},rotate=function(t){return" rotate("+t+"deg) "},has=function(t,e){return Object.prototype.hasOwnProperty.call(e,t)},getPrefix=function(){var t=["Moz","Webkit","Khtml","O","ms"],e=t.length,a="";while(e--)t[e]+"Transform"in document.body.style&&(a="-"+t[e].toLowerCase()+"-");return a},gradient=function(t,e,a,i,s){var n,o=[];if("-webkit-"==r){for(n=0;n<s;n++)o.push("color-stop("+i[n][0]+", "+i[n][1]+")");t.css({"background-image":"-webkit-gradient(linear, "+e.x+"% "+e.y+"%,  "+a.x+"% "+a.y+"%, "+o.join(",")+" )"})}else{e={x:e.x/100*t.width(),y:e.y/100*t.height()};a={x:a.x/100*t.width(),y:a.y/100*t.height()};var p=a.x-e.x,h=a.y-e.y,l=Math.atan2(h,p),g=l-Math.PI/2,d=Math.abs(t.width()*Math.sin(g))+Math.abs(t.height()*Math.cos(g)),u=Math.sqrt(h*h+p*p),c=point2D(a.x<e.x?t.width():0,a.y<e.y?t.height():0),v=Math.tan(l),w=-1/v,b=(w*c.x-c.y-v*e.x+e.y)/(w-v),x={x:b,y:w*b-w*c.x+c.y},m=Math.sqrt(Math.pow(x.x-e.x,2)+Math.pow(x.y-e.y,2));for(n=0;n<s;n++)o.push(" "+i[n][1]+" "+100*(m+u*i[n][0])/d+"%");t.css({"background-image":r+"linear-gradient("+-l+"rad,"+o.join(",")+")"})}},v={init:function(t){if(void 0===i){i="WebKitCSSMatrix"in window||"MozPerspective"in document.body.style;r=getPrefix()}var s,n=this.data(),l=this.children();t=a.extend({width:this.width(),height:this.height()},g,t);n.opts=t;n.pageObjs={};n.pages={};n.pageWrap={};n.pagePlace={};n.pageMv=[];n.totalPages=t.pages||0;if(t.when)for(s in t.when)has(s,t.when)&&this.bind(s,t.when[s]);this.css({position:"relative",width:t.width,height:t.height});this.turn("display",t.display);i&&!o&&t.acceleration&&this.transform(translate(0,0,true));for(s=0;s<l.length;s++)this.turn("addPage",l[s],s+1);this.turn("page",t.page);h=a.extend({},h,t.corners);a(this||e).bind(p.start,(function(t){for(var e in n.pages)if(has(e,n.pages)&&false===w._eventStart.call(n.pages[e],t))return false}));a(document).bind(p.move,(function(t){for(var e in n.pages)has(e,n.pages)&&w._eventMove.call(n.pages[e],t)})).bind(p.end,(function(t){for(var e in n.pages)has(e,n.pages)&&w._eventEnd.call(n.pages[e],t)}));n.done=true;return this||e},addPage:function(t,i){var r=false,s=this.data(),n=s.totalPages+1;if(i){if(i==n){i=n;r=true}else if(i>n)throw new Error('It is impossible to add the page "'+i+'", the maximum value is: "'+n+'"')}else{i=n;r=true}if(i>=1&&i<=n){s.done&&this.turn("stop");i in s.pageObjs&&v._movePages.call(this||e,i,1);r&&(s.totalPages=n);s.pageObjs[i]=a(t).addClass("turn-page p"+i);v._addPage.call(this||e,i);s.done&&this.turn("update");v._removeFromDOM.call(this||e)}return this||e},_addPage:function(t){var i=this.data(),r=i.pageObjs[t];if(r)if(v._necessPage.call(this||e,t)){if(!i.pageWrap[t]){var s="double"==i.display?this.width()/2:this.width(),n=this.height();r.css({width:s,height:n});i.pagePlace[t]=t;i.pageWrap[t]=a("<div/>",{class:"turn-page-wrapper",page:t,css:{position:"absolute",overflow:"hidden",width:s,height:n}}).css(c["double"==i.display?t%2:0]);this.append(i.pageWrap[t]);i.pageWrap[t].prepend(i.pageObjs[t])}t&&1!=v._setPageLoc.call(this||e,t)||v._makeFlip.call(this||e,t)}else{i.pagePlace[t]=0;i.pageObjs[t]&&i.pageObjs[t].remove()}},hasPage:function(t){return t in this.data().pageObjs},_makeFlip:function(t){var a=this.data();if(!a.pages[t]&&a.pagePlace[t]==t){var i="single"==a.display,r=t%2;a.pages[t]=a.pageObjs[t].css({width:i?this.width():this.width()/2,height:this.height()}).flip({page:t,next:i&&t===a.totalPages?t-1:r||i?t+1:t-1,turn:this||e,duration:a.opts.duration,acceleration:a.opts.acceleration,corners:i?"all":r?"forward":"backward",backGradient:a.opts.gradients,frontGradient:a.opts.gradients}).flip("disable",a.disabled).bind("pressed",v._pressed).bind("released",v._released).bind("start",v._start).bind("end",v._end).bind("flip",v._flip)}return a.pages[t]},_makeRange:function(){var t,a=this.data(),i=this.turn("range");for(t=i[0];t<=i[1];t++)v._addPage.call(this||e,t)},range:function(t){var a,i,r,s=this.data();t=t||s.tpage||s.page;var n=v._view.call(this||e,t);if(t<1||t>s.totalPages)throw new Error('"'+t+'" is not a page for range');n[1]=n[1]||n[0];if(n[0]>=1&&n[1]<=s.totalPages){a=Math.floor((u-2)/2);if(s.totalPages-n[1]>n[0]){i=Math.min(n[0]-1,a);r=2*a-i}else{r=Math.min(s.totalPages-n[1],a);i=2*a-r}}else{i=u-1;r=u-1}return[Math.max(1,n[0]-i),Math.min(s.totalPages,n[1]+r)]},_necessPage:function(t){if(0===t)return true;var e=this.turn("range");return t>=e[0]&&t<=e[1]},_removeFromDOM:function(){var t,a=this.data();for(t in a.pageWrap)has(t,a.pageWrap)&&!v._necessPage.call(this||e,t)&&v._removePageFromDOM.call(this||e,t)},_removePageFromDOM:function(t){var e=this.data();if(e.pages[t]){var a=e.pages[t].data();a.f&&a.f.fwrapper&&a.f.fwrapper.remove();e.pages[t].remove();delete e.pages[t]}e.pageObjs[t]&&e.pageObjs[t].remove();if(e.pageWrap[t]){e.pageWrap[t].remove();delete e.pageWrap[t]}delete e.pagePlace[t]},removePage:function(t){var a=this.data();if(a.pageObjs[t]){this.turn("stop");v._removePageFromDOM.call(this||e,t);delete a.pageObjs[t];v._movePages.call(this||e,t,-1);a.totalPages=a.totalPages-1;v._makeRange.call(this||e);a.page>a.totalPages&&this.turn("page",a.totalPages)}return this||e},_movePages:function(t,e){var a,i=this.data(),r="single"==i.display,move=function(t){var a=t+e,s=a%2;i.pageObjs[t]&&(i.pageObjs[a]=i.pageObjs[t].removeClass("page"+t).addClass("page"+a));if(i.pagePlace[t]&&i.pageWrap[t]){i.pagePlace[a]=a;i.pageWrap[a]=i.pageWrap[t].css(c[r?0:s]).attr("page",a);i.pages[t]&&(i.pages[a]=i.pages[t].flip("options",{page:a,next:r||s?a+1:a-1,corners:r?"all":s?"forward":"backward"}));if(e){delete i.pages[t];delete i.pagePlace[t];delete i.pageObjs[t];delete i.pageWrap[t];delete i.pageObjs[t]}}};if(e>0)for(a=i.totalPages;a>=t;a--)move(a);else for(a=t;a<=i.totalPages;a++)move(a)},display:function(t){var i=this.data(),r=i.display;if(t){if(-1==a.inArray(t,l))throw new Error('"'+t+'" is not a value for display');if("single"==t){if(!i.pageObjs[0]){this.turn("stop").css({overflow:"hidden"});i.pageObjs[0]=a("<div />",{class:"turn-page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this||e)}}else if(i.pageObjs[0]){this.turn("stop").css({overflow:""});i.pageObjs[0].remove();delete i.pageObjs[0]}i.display=t;if(r){var s=this.turn("size");v._movePages.call(this||e,1,0);this.turn("size",s.width,s.height).turn("update")}return this||e}return r},animating:function(){return this.data().pageMv.length>0},disable:function(t){var i,r=this.data(),s=this.turn("view");r.disabled=void 0===t||true===t;for(i in r.pages)has(i,r.pages)&&r.pages[i].flip("disable",!!t&&a.inArray(i,s));return this||e},size:function(t,a){if(t&&a){var i=this.data(),r="double"==i.display?t/2:t,s;this.css({width:t,height:a});i.pageObjs[0]&&i.pageObjs[0].css({width:r,height:a});for(s in i.pageWrap)if(has(s,i.pageWrap)){i.pageObjs[s].css({width:r,height:a});i.pageWrap[s].css({width:r,height:a});i.pages[s]&&i.pages[s].css({width:r,height:a})}this.turn("resize");return this||e}return{width:this.width(),height:this.height()}},resize:function(){var t,e=this.data();if(e.pages[0]){e.pageWrap[0].css({left:-this.width()});e.pages[0].flip("resize",true)}for(t=1;t<=e.totalPages;t++)e.pages[t]&&e.pages[t].flip("resize",true)},_removeMv:function(t){var e,a=this.data();for(e=0;e<a.pageMv.length;e++)if(a.pageMv[e]==t){a.pageMv.splice(e,1);return true}return false},_addMv:function(t){var a=this.data();v._removeMv.call(this||e,t);a.pageMv.push(t)},_view:function(t){var e=this.data();t=t||e.page;return"double"==e.display?t%2?[t-1,t]:[t,t+1]:[t]},view:function(t){var a=this.data(),i=v._view.call(this||e,t);return"double"==a.display?[i[0]>0?i[0]:0,i[1]<=a.totalPages?i[1]:0]:[i[0]>0&&i[0]<=a.totalPages?i[0]:0]},stop:function(t){var a,i,r=this.data(),s=r.pageMv;r.pageMv=[];if(r.tpage){r.page=r.tpage;delete r["tpage"]}for(a in s)if(has(a,s)){i=r.pages[s[a]].data().f.opts;w._moveFoldingPage.call(r.pages[s[a]],null);r.pages[s[a]].flip("hideFoldedPage");r.pagePlace[i.next]=i.next;if(i.force){i.next=i.page%2===0?i.page-1:i.page+1;delete i["force"]}}this.turn("update");return this||e},pages:function(t){var a=this.data();if(t){if(t<a.totalPages){for(var i=t+1;i<=a.totalPages;i++)this.turn("removePage",i);this.turn("page")>t&&this.turn("page",t)}a.totalPages=t;return this||e}return a.totalPages},_fitPage:function(t,i){var r=this.data(),s=this.turn("view",t);if(r.page!=t){this.trigger("turning",[t,s]);-1!=a.inArray(1,s)&&this.trigger("first");-1!=a.inArray(r.totalPages,s)&&this.trigger("last")}if(r.pageObjs[t]){r.tpage=t;this.turn("stop",i);v._removeFromDOM.call(this||e);v._makeRange.call(this||e);this.trigger("turned",[t,s])}},_turnPage:function(t){var i,r,s=this.data(),n=this.turn("view"),o=this.turn("view",t);if(s.page!=t){this.trigger("turning",[t,o]);-1!=a.inArray(1,o)&&this.trigger("first");-1!=a.inArray(s.totalPages,o)&&this.trigger("last")}if(s.pageObjs[t]){s.tpage=t;this.turn("stop");v._makeRange.call(this||e);if("single"==s.display){i=n[0];r=o[0]}else if(n[1]&&t>n[1]){i=n[1];r=o[0]}else if(n[0]&&t<n[0]){i=n[0];r=o[1]}if(s.pages[i]){var p=s.pages[i].data().f.opts;s.tpage=r;if(p.next!=r){p.next=r;s.pagePlace[r]=p.page;p.force=true}"single"==s.display?s.pages[i].flip("turnPage",o[0]>n[0]?"br":"bl"):s.pages[i].flip("turnPage")}}},page:function(t){t=parseInt(t,10);var i=this.data();if(t>0&&t<=i.totalPages){i.done&&-1==a.inArray(t,this.turn("view"))?v._turnPage.call(this||e,t):v._fitPage.call(this||e,t);return this||e}return i.page},next:function(){var t=this.data();return this.turn("page",v._view.call(this||e,t.page).pop()+1)},previous:function(){var t=this.data();return this.turn("page",v._view.call(this||e,t.page).shift()-1)},_addMotionPage:function(){var t=a(this||e).data().f.opts,i=t.turn,r=i.data();t.pageMv=t.page;v._addMv.call(i,t.pageMv);r.pagePlace[t.next]=t.page;i.turn("update")},_start:function(t,i,r){var s=i.turn.data(),n=a.Event("start");t.stopPropagation();i.turn.trigger(n,[i,r]);if(n.isDefaultPrevented())t.preventDefault();else{if("single"==s.display){var o="l"==r.charAt(1);if(1==i.page&&o||i.page==s.totalPages&&!o)t.preventDefault();else if(o){i.next=i.next<i.page?i.next:i.page-1;i.force=true}else i.next=i.next>i.page?i.next:i.page+1}v._addMotionPage.call(this||e)}},_end:function(t,i){var r=a(this||e),s=r.data().f,n=s.opts,o=n.turn,p=o.data();t.stopPropagation();if(i||p.tpage){if(p.tpage==n.next||p.tpage==n.page){delete p["tpage"];v._fitPage.call(o,p.tpage||n.next,true)}}else{v._removeMv.call(o,n.pageMv);o.turn("update")}},_pressed:function(){var t,i=a(this||e),r=i.data().f,s=r.opts.turn,n=s.data().pages;for(t in n)t!=r.opts.page&&n[t].flip("disable",true);return r.time=(new Date).getTime()},_released:function(t,i){var r=a(this||e),s=r.data().f;t.stopPropagation();if((new Date).getTime()-s.time<200||i.x<0||i.x>a(this||e).width()){t.preventDefault();s.opts.turn.data().tpage=s.opts.next;s.opts.turn.turn("update");a(r).flip("turnPage")}},_flip:function(){var t=a(this||e).data().f.opts;t.turn.trigger("turn",[t.next])},calculateZ:function(t){var a,i,r,s,n,o=this||e,p=this.data(),h=this.turn("view"),l=h[0]||h[1],g={pageZ:{},partZ:{},pageV:{}},addView=function(t){var e=o.turn("view",t);e[0]&&(g.pageV[e[0]]=true);e[1]&&(g.pageV[e[1]]=true)};for(a=0;a<t.length;a++){i=t[a];r=p.pages[i].data().f.opts.next;s=p.pagePlace[i];addView(i);addView(r);n=p.pagePlace[r]==r?r:i;g.pageZ[n]=p.totalPages-Math.abs(l-n);g.partZ[s]=2*p.totalPages+Math.abs(l-n)}return g},update:function(){var t,a=this.data();if(a.pageMv.length&&0!==a.pageMv[0]){var i,r=this.turn("calculateZ",a.pageMv),s=this.turn("view",a.tpage);a.pagePlace[s[0]]==s[0]?i=s[0]:a.pagePlace[s[1]]==s[1]&&(i=s[1]);for(t in a.pageWrap)if(has(t,a.pageWrap)){a.pageWrap[t].css({display:r.pageV[t]?"":"none","z-index":r.pageZ[t]||0});if(a.pages[t]){a.pages[t].flip("z",r.partZ[t]||null);r.pageV[t]&&a.pages[t].flip("resize");a.tpage&&a.pages[t].flip("disable",true)}}}else for(t in a.pageWrap)if(has(t,a.pageWrap)){var n=v._setPageLoc.call(this||e,t);a.pages[t]&&a.pages[t].flip("disable",a.disabled||1!=n).flip("z",null)}},_setPageLoc:function(t){var e=this.data(),a=this.turn("view");if(t==a[0]||t==a[1]){e.pageWrap[t].css({"z-index":e.totalPages,display:""});return 1}if("single"==e.display&&t==a[0]+1||"double"==e.display&&t==a[0]-2||t==a[1]+2){e.pageWrap[t].css({"z-index":e.totalPages-1,display:""});return 2}e.pageWrap[t].css({"z-index":0,display:"none"});return 0}},w={init:function(t){if(t.gradients){t.frontGradient=true;t.backGradient=true}this.data({f:{}});this.flip("options",t);w._addPageWrapper.call(this||e);return this||e},setData:function(t){var i=this.data();i.f=a.extend(i.f,t);return this||e},options:function(t){var i=this.data().f;if(t){w.setData.call(this||e,{opts:a.extend({},i.opts||d,t)});return this||e}return i.opts},z:function(t){var a=this.data().f;a.opts["z-index"]=t;a.fwrapper.css({"z-index":t||parseInt(a.parent.css("z-index"),10)||0});return this||e},_cAllowed:function(){return h[this.data().f.opts.corners]||this.data().f.opts.corners},_cornerActivated:function(t){if(void 0===t.originalEvent)return false;t=o?t.originalEvent.touches:[t];var i=this.data().f,r=i.parent.offset(),s=this.width(),n=this.height(),p={x:Math.max(0,t[0].pageX-r.left),y:Math.max(0,t[0].pageY-r.top)},h=i.opts.cornerSize,l=w._cAllowed.call(this||e);if(p.x<=0||p.y<=0||p.x>=s||p.y>=n)return false;if(p.y<h)p.corner="t";else{if(!(p.y>=n-h))return false;p.corner="b"}if(p.x<=h)p.corner+="l";else{if(!(p.x>=s-h))return false;p.corner+="r"}return-1!=a.inArray(p.corner,l)&&p},_c:function(t,e){e=e||0;return{tl:point2D(e,e),tr:point2D(this.width()-e,e),bl:point2D(e,this.height()-e),br:point2D(this.width()-e,this.height()-e)}[t]},_c2:function(t){return{tl:point2D(2*this.width(),0),tr:point2D(-this.width(),0),bl:point2D(2*this.width(),this.height()),br:point2D(-this.width(),this.height())}[t]},_foldingPage:function(t){var e=this.data().f.opts;if(e.folding)return e.folding;if(e.turn){var a=e.turn.data();return"single"==a.display?a.pageObjs[e.next]?a.pageObjs[0]:null:a.pageObjs[e.next]}},_backGradient:function(){var t=this.data().f,e=t.opts.turn,i=t.opts.backGradient&&(!e||"single"==e.data().display||2!=t.opts.page&&t.opts.page!=e.data().totalPages-1);i&&!t.bshadow&&(t.bshadow=a("<div/>",divAtt(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(t.parent));return i},resize:function(t){var a=this.data().f,i=this.width(),r=this.height(),s=Math.round(Math.sqrt(Math.pow(i,2)+Math.pow(r,2)));if(t){a.wrapper.css({width:s,height:s});a.fwrapper.css({width:s,height:s}).children(":first-child").css({width:i,height:r});a.fpage.css({width:r,height:i});a.opts.frontGradient&&a.ashadow.css({width:r,height:i});w._backGradient.call(this||e)&&a.bshadow.css({width:i,height:r})}if(a.parent.is(":visible")){a.fwrapper.css({top:a.parent.offset().top,left:a.parent.offset().left});a.opts.turn&&a.fparent.css({top:-a.opts.turn.offset().top,left:-a.opts.turn.offset().left})}this.flip("z",a.opts["z-index"])},_addPageWrapper:function(){var t,i=this.data().f,r=this.parent();if(!i.wrapper){var s=this.css("left"),n=this.css("top"),o=this.width(),p=this.height(),h=Math.round(Math.sqrt(Math.pow(o,2)+Math.pow(p,2)));i.parent=r;i.fparent=i.opts.turn?i.opts.turn.data().fparent:a("#turn-fwrappers");if(!i.fparent){var l=a("<div/>",{css:{"pointer-events":"none"}}).hide();l.data().flips=0;if(i.opts.turn){l.css(divAtt(-i.opts.turn.offset().top,-i.opts.turn.offset().left,"auto","visible").css).appendTo(i.opts.turn);i.opts.turn.data().fparent=l}else l.css(divAtt(0,0,"auto","visible").css).attr("id","turn-fwrappers").appendTo(a("body"));i.fparent=l}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"});i.wrapper=a("<div/>",divAtt(0,0,this.css("z-index"))).appendTo(r).prepend(this||e);i.fwrapper=a("<div/>",divAtt(r.offset().top,r.offset().left)).hide().appendTo(i.fparent);i.fpage=a("<div/>",{css:{cursor:"default"}}).appendTo(a("<div/>",divAtt(0,0,0,"visible")).appendTo(i.fwrapper));i.opts.frontGradient&&(i.ashadow=a("<div/>",divAtt(0,0,1)).appendTo(i.fpage));w.setData.call(this||e,i);w.resize.call(this||e,true)}},_fold:function(t){var a=this||e,i=0,r=0,o,p,h,l,g,d,u,c=point2D(0,0),v=point2D(0,0),b=point2D(0,0),x=this.width(),m=this.height(),y=w._foldingPage.call(this||e),P=Math.tan(r),M=this.data().f,_=M.opts.acceleration,O=M.wrapper.height(),j=w._c.call(this||e,t.corner),W="t"==t.corner.substr(0,1),z="l"==t.corner.substr(1,1),compute=function(){var e=point2D(j.x?j.x-t.x:t.x,j.y?j.y-t.y:t.y),o=Math.atan2(e.y,e.x),y;r=n-o;i=deg(r);y=point2D(z?x-e.x/2:t.x+e.x/2,e.y/2);var P=r-Math.atan2(y.y,y.x),_=Math.max(0,Math.sin(P)*Math.sqrt(Math.pow(y.x,2)+Math.pow(y.y,2)));b=point2D(_*Math.sin(r),_*Math.cos(r));if(r>n){b.x=b.x+Math.abs(b.y*Math.tan(o));b.y=0;if(Math.round(b.x*Math.tan(s-r))<m){t.y=Math.sqrt(Math.pow(m,2)+2*y.x*e.x);W&&(t.y=m-t.y);return compute()}}if(r>n){var k=s-r,F=O-m/Math.sin(k);c=point2D(Math.round(F*Math.cos(k)),Math.round(F*Math.sin(k)));z&&(c.x=-c.x);W&&(c.y=-c.y)}p=Math.round(b.y/Math.tan(r)+b.x);var D=x-p,T=D*Math.cos(2*r),A=D*Math.sin(2*r);v=point2D(Math.round(z?D-T:p+T),Math.round(W?A:m-A));d=D*Math.sin(r);var G=w._c2.call(a,t.corner),E=Math.sqrt(Math.pow(G.x-t.x,2)+Math.pow(G.y-t.y,2));u=E<x?E/x:1;if(M.opts.frontGradient){g=d>100?(d-100)/d:0;h=point2D(d*Math.sin(n-r)/m*100,d*Math.cos(n-r)/x*100);W&&(h.y=100-h.y);z&&(h.x=100-h.x)}if(w._backGradient.call(a)){l=point2D(d*Math.sin(r)/x*100,d*Math.cos(r)/m*100);z||(l.x=100-l.x);W||(l.y=100-l.y)}b.x=Math.round(b.x);b.y=Math.round(b.y);return true},transform=function(t,e,i,s){var n=["0","auto"],o=(x-O)*i[0]/100,p=(m-O)*i[1]/100,d={left:n[e[0]],top:n[e[1]],right:n[e[2]],bottom:n[e[3]]},b=90!=s&&-90!=s?z?-1:1:0;i=i[0]+"% "+i[1]+"%";a.css(d).transform(rotate(s)+translate(t.x+b,t.y,_),i);M.fpage.parent().css(d);M.wrapper.transform(translate(-t.x+o-b,-t.y+p,_)+rotate(-s),i);M.fwrapper.transform(translate(-t.x+c.x+o,-t.y+c.y+p,_)+rotate(-s),i);M.fpage.parent().transform(rotate(s)+translate(t.x+v.x-c.x,t.y+v.y-c.y,_),i);M.opts.frontGradient&&gradient(M.ashadow,point2D(z?100:0,W?100:0),point2D(h.x,h.y),[[g,"rgba(0,0,0,0)"],[.8*(1-g)+g,"rgba(0,0,0,"+.2*u+")"],[1,"rgba(255,255,255,"+.2*u+")"]],3,r);w._backGradient.call(a)&&gradient(M.bshadow,point2D(z?0:100,W?0:100),point2D(l.x,l.y),[[.8,"rgba(0,0,0,0)"],[1,"rgba(0,0,0,"+.3*u+")"],[1,"rgba(0,0,0,0)"]],3)};switch(t.corner){case"tl":t.x=Math.max(t.x,1);compute();transform(b,[1,0,0,1],[100,0],i);M.fpage.transform(translate(-m,-x,_)+rotate(90-2*i),"100% 100%");y.transform(rotate(90)+translate(0,-m,_),"0% 0%");break;case"tr":t.x=Math.min(t.x,x-1);compute();transform(point2D(-b.x,b.y),[0,0,0,1],[0,0],-i);M.fpage.transform(translate(0,-x,_)+rotate(-90+2*i),"0% 100%");y.transform(rotate(270)+translate(-x,0,_),"0% 0%");break;case"bl":t.x=Math.max(t.x,1);compute();transform(point2D(b.x,-b.y),[1,1,0,0],[100,100],-i);M.fpage.transform(translate(-m,0,_)+rotate(-90+2*i),"100% 0%");y.transform(rotate(270)+translate(-x,0,_),"0% 0%");break;case"br":t.x=Math.min(t.x,x-1);compute();transform(point2D(-b.x,-b.y),[0,1,1,0],[0,100],i);M.fpage.transform(rotate(90-2*i),"0% 0%");y.transform(rotate(90)+translate(0,-m,_),"0% 0%");break}M.point=t},_moveFoldingPage:function(t){var a=this.data().f,i=w._foldingPage.call(this||e);if(i)if(t){if(!a.fpage.children()[a.ashadow?"1":"0"]){w.setData.call(this||e,{backParent:i.parent()});a.fpage.prepend(i)}}else a.backParent&&a.backParent.prepend(i)},_showFoldedPage:function(t,i){var r=w._foldingPage.call(this||e),s=this.data(),n=s.f;if(!n.point||n.point.corner!=t.corner){var o=a.Event("start");this.trigger(o,[n.opts,t.corner]);if(o.isDefaultPrevented())return false}if(r){if(i){var p=this||e,h=n.point&&n.point.corner==t.corner?n.point:w._c.call(this||e,t.corner,1);this.animatef({from:[h.x,h.y],to:[t.x,t.y],duration:500,frame:function(e){t.x=Math.round(e[0]);t.y=Math.round(e[1]);w._fold.call(p,t)}})}else{w._fold.call(this||e,t);s.effect&&!s.effect.turning&&this.animatef(false)}if(!n.fwrapper.is(":visible")){n.fparent.show().data().flips++;w._moveFoldingPage.call(this||e,true);n.fwrapper.show();n.bshadow&&n.bshadow.show()}return true}return false},hide:function(){var t=this.data().f,a=w._foldingPage.call(this||e);0===--t.fparent.data().flips&&t.fparent.hide();this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform("","0% 100%");t.wrapper.transform("","0% 100%");t.fwrapper.hide();t.bshadow&&t.bshadow.hide();a.transform("","0% 0%");return this||e},hideFoldedPage:function(t){var a=this.data().f;if(a.point){var i=this||e,r=a.point,hide=function(){a.point=null;i.flip("hide");i.trigger("end",[false])};if(t){var s=w._c.call(this||e,r.corner),n="t"==r.corner.substr(0,1),o=n?Math.min(0,r.y-s.y)/2:Math.max(0,r.y-s.y)/2,p=point2D(r.x,r.y+o),h=point2D(s.x,s.y-o);this.animatef({from:0,to:1,frame:function(t){var e=bezier(r,p,h,s,t);r.x=e.x;r.y=e.y;w._fold.call(i,r)},complete:hide,duration:800,hiding:true})}else{this.animatef(false);hide()}}},turnPage:function(t){var a=this||e,i=this.data().f;t={corner:i.corner?i.corner.corner:t||w._cAllowed.call(this||e)[0]};var r=i.point||w._c.call(this||e,t.corner,i.opts.turn?i.opts.turn.data().opts.elevation:0),s=w._c2.call(this||e,t.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(e){var i=bezier(r,r,s,s,e);t.x=i.x;t.y=i.y;w._showFoldedPage.call(a,t)},complete:function(){a.trigger("end",[true])},duration:i.opts.duration,turning:true});i.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(t){var a=this.data().f;if(!a.disabled&&!this.flip("isTurning")){a.corner=w._cornerActivated.call(this||e,t);if(a.corner&&w._foldingPage.call(this||e,a.corner)){w._moveFoldingPage.call(this||e,true);this.trigger("pressed",[a.point]);return false}a.corner=null}},_eventMove:function(t){var a=this.data().f;if(!a.disabled){t=o?t.originalEvent.touches:[t];if(a.corner){var i=a.parent.offset();a.corner.x=t[0].pageX-i.left;a.corner.y=t[0].pageY-i.top;w._showFoldedPage.call(this||e,a.corner)}else if(!this.data().effect&&this.is(":visible")){var r=w._cornerActivated.call(this||e,t[0]);if(r){var s=w._c.call(this||e,r.corner,a.opts.cornerSize/2);r.x=s.x;r.y=s.y;w._showFoldedPage.call(this||e,r,true)}else w.hideFoldedPage.call(this||e,true)}}},_eventEnd:function(){var t=this.data().f;if(!t.disabled&&t.point){var i=a.Event("released");this.trigger(i,[t.point]);i.isDefaultPrevented()||w.hideFoldedPage.call(this||e,true)}t.corner=null},disable:function(t){w.setData.call(this||e,{disabled:t});return this||e}},cla=function(t,e,a){if(a[0]&&"object"!=typeof a[0]){if(e[a[0]]&&"_"!=a[0].toString().substr(0,1))return e[a[0]].apply(t,Array.prototype.slice.call(a,1));throw a[0]+" is an invalid value"}return e.init.apply(t,a)};a.extend(a.fn,{flip:function(t,a){return cla(this||e,w,arguments)},turn:function(t){return cla(this||e,v,arguments)},transform:function(t,e){var a={};e&&(a[r+"transform-origin"]=e);a[r+"transform"]=t;return this.css(a)},animatef:function(t){var a=this.data();a.effect&&clearInterval(a.effect.handle);if(t){t.to.length||(t.to=[t.to]);t.from.length||(t.from=[t.from]);t.easing||(t.easing=function(t,e,a,i,r){return i*Math.sqrt(1-(e=e/r-1)*e)+a});var i,r=[],s=t.to.length,n=this||e,o=t.fps||30,p=-o,f=function(){var e,i=[];p=Math.min(t.duration,p+o);for(e=0;e<s;e++)i.push(t.easing(1,p,t.from[e],r[e],t.duration));t.frame(1==s?i[0]:i);if(p==t.duration){clearInterval(a.effect.handle);delete a["effect"];n.data(a);t.complete&&t.complete()}};for(i=0;i<s;i++)r.push(t.to[i]-t.from[i]);a.effect=t;a.effect.handle=setInterval(f,o);this.data(a);f()}else delete a["effect"]}});a.isTouch=o;var b={};export default b;

